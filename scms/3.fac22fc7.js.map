{"version":3,"sources":["webpack:///./login/js/index.js"],"names":["verify","num","$text","$","username","val","password","captcha","text","removeClass","key","$span","$getCaptcha1","$getCaptcha2","$errorMsg","$errorDialog","append","document","on","hide","location","hostname","addClass","cookie","removeCookie","path","login","json","ajax","url","type","data","identifycode","success","result","session_key","jobcard","setTimeout","window","href","code","show","msg","error","time","css","display","timer","setInterval","clearInterval","keydown","e","keyCode","focus"],"mappings":"wGAyKA,SAASA,OAAOC,KACd,IAAIC,MAAQC,EAAE,oBACVC,SAAWD,EAAE,aAAaE,MAC5BC,SAAWH,EAAE,aAAaE,MAC1BE,QAAUJ,EAAE,YAAYE,MAC1B,GAAKD,SAIL,GAAKE,SAAL,CAIA,GAAKC,SAAYN,IAKjB,OADAC,MAAMM,KAAK,KAETJ,SAAUA,SACVE,SAAUA,SACVC,QAASA,SAPTL,MAAMM,KAAK,eAJXN,MAAMM,KAAK,gBAJXN,MAAMM,KAAK,iBA/KfL,EAAE,WACAA,EAAE,gBAAgBM,YAAY,aAE9B,IAOIC,IAPAR,MAAQC,EAAE,oBACVQ,MAAQR,EAAE,wBACVS,aAAeT,EAAE,iBACjBU,aAAeV,EAAE,iBACjBW,UAAYX,EAAE,mBACdY,aAAeZ,EAAE,iBAuBrB,IAAKO,OAnBLP,EAAE,mBAAmBa,OACnB,uPAQFb,EAAEc,UAAUC,GAAG,QAAS,WAAY,WAClCf,EAAE,sBAAsBgB,SAGD,oBAAtBC,SAASC,SACVlB,EAAE,gBAAgBmB,SAAS,YAAYb,YAAY,YAEnDN,EAAE,gBAAgBmB,SAAS,YAAYb,YAAY,YAGzCN,EAAEoB,SACD,YAARb,MACDP,EAAEqB,aAAad,KACfP,EAAEqB,aAAad,KAAOe,KAAM,OAwEhC,SAASC,QACP,IAAIC,KAAO3B,SACN2B,MAGLxB,EAAEyB,MACAC,IAAK,uCACLC,KAAM,OACNC,MACE3B,SAAUuB,KAAKvB,SACfE,SAAUqB,KAAKrB,SACf0B,aAAcL,KAAKpB,SAErB0B,QAAS,SAASF,MACZA,KACkB,YAAhBA,KAAKG,QACP/B,EAAEoB,OAAO,cAAeQ,KAAKA,KAAKI,aAChCV,KAAM,MAGRtB,EAAEoB,OAAO,UAAWQ,KAAKA,KAAKK,SAC5BX,KAAM,MAGRtB,EAAEoB,OAAO,WAAYQ,KAAKA,KAAK3B,UAC7BqB,KAAM,MAGRtB,EAAE,cAAcmB,SAAS,aACzBnB,EAAE,iBAAiBM,YAAY,uBAC/B4B,WAAW,WACTlC,EAAE,iBAAiBmB,SAAS,sBAE9Be,WAAW,WAKPC,OAAOlB,SAASmB,KAAO,UAExB,MAEe,mBAAdR,KAAKS,MACPzB,aAAa0B,OACb3B,UAAUN,KACR,oEAEFL,EAAE,iBAAiBmB,SAAS,OAE5BpB,MAAMM,KAAKuB,KAAKW,KAIpBxC,MAAMM,KAAK,SAGfmC,MAAO,WACLzC,MAAMM,KAAK,WA9HjBO,aAAaI,OAEbP,aAAaM,GAAG,QAAS,WACvB,IAAIS,KAAO3B,OAAO,GACd4C,KAAO,GACNjB,MAILxB,EAAEyB,MACAC,IAAK,+CACLC,KAAM,OACNC,MACE3B,SAAUuB,KAAKvB,SACfE,SAAUqB,KAAKrB,UAEjB2B,QAAS,SAASF,MAChB,GAAIA,KACF,GAAoB,YAAhBA,KAAKG,OAMPhC,MAAMM,KAAKuB,KAAKW,SACb,CACH9B,aAAaO,OACbN,aAAagC,KAAKC,QAAS,WAC3BnC,MAAMH,KAAKoC,MACX,IAAIG,MAAQC,YACV,WACMJ,MAAQ,GACVK,cAAcF,OACdnC,aAAaiC,KAAMC,QAAS,WAC5BjC,aAAaM,SAEbyB,MAAc,EACdjC,MAAMH,KAAKoC,QAGf,IACA,SAIJ1C,MAAMM,KAAK,mBAGfmC,MAAO,WACLzC,MAAMM,KAAK,uBAKjBL,EAAE,YAAY+C,QAAQ,SAASC,GACZ,IAAbA,EAAEC,SACJ1B,UAGJvB,EAAE,WAAWe,GAAG,QAAS,WACvBQ,UAEFvB,EAAE,aAAakD,QACflD,EAAE,gBAAgBe,GAAG,QAAS,WAC5BH,aAAaI,OACbL,UAAUN,OACVL,EAAE,iBAAiBM,YAAY","file":"3.fac22fc7.js","sourcesContent":["$(function() {\n  $('#J_LoginPage').removeClass('not-ready');\n\n  var $text = $('.login-error-msg');\n  var $span = $('#get-captcha2 > span');\n  var $getCaptcha1 = $('#get-captcha1');\n  var $getCaptcha2 = $('#get-captcha2');\n  var $errorMsg = $('.dialog-message');\n  var $errorDialog = $('.login-dialog');\n  // var regExp = new RegExp(/[a-zA-Z:\\(\\)/-]/g);\n  var key;\n\n  $('.loginIndexPage').append(\n    '<div class=\"qrcode-for-mobile\">' +\n      '<div class=\"qr-header\">移动风豹</div>' +\n      '<a id=\"closeQr\" type=\"button\" class=\"close-me\"><span aria-hidden=\"true\">&times;</span></a>' +\n      '<div id=\"qrcodeImage\" class=\"qr-bg-img\"></div>' +\n      '<div class=\"qr-footer\">货嘀移动办公小秘</div>' +\n    '</div>'\n  );\n\n  $(document).on('click', '#closeQr', () => {\n    $('.qrcode-for-mobile').hide();\n  });\n\n  if(location.hostname === 'scms.ehuodi.com'){\n    $('#qrcodeImage').addClass('for-prod').removeClass('for-test');\n  }else{\n    $('#qrcodeImage').addClass('for-test').removeClass('for-prod');\n  }\n\n  for (key in $.cookie()) {\n    if(key !== 'updater'){\n      $.removeCookie(key);\n      $.removeCookie(key, { path: '/' });\n    }\n  }\n  $errorDialog.hide();\n\n  $getCaptcha1.on('click', function() {\n    var json = verify(1);\n    var time = 60;\n    if (!json) {\n      return;\n    }\n    \n    $.ajax({\n      url: '/ehuodiBedrockApi/baseconfigcs/loginIdentify',\n      type: 'post',\n      data: {\n        username: json.username,\n        password: json.password,\n      },\n      success: function(data) {\n        if (data) {\n          if (data.result !== 'success') {\n            // if (data.msg.replace(regExp, '') === '') {\n            //   $text.text('获取验证码失败，请稍后再试。');\n            // } else {\n            //   $text.text(data.msg.replace(regExp, ''));\n            // }\n            $text.text(data.msg);\n          }else{\n            $getCaptcha1.hide();\n            $getCaptcha2.css({display: 'inline'});\n            $span.text(time);\n            var timer = setInterval(\n              function() {\n                if (time <= 0) {\n                  clearInterval(timer);\n                  $getCaptcha1.css({ display: 'inline' });\n                  $getCaptcha2.hide();\n                } else {\n                  time = time - 1;\n                  $span.text(time);\n                }\n              },\n              1000,\n              60\n            );\n          }\n        } else {\n          $text.text('获取验证码失败，请稍后再试。');\n        }\n      },\n      error: function() {\n        $text.text('获取验证码失败，请稍后再试。');\n      },\n    });\n  });\n\n  $('#captcha').keydown(function(e) {\n    if (e.keyCode == 13) {\n      login();\n    }\n  });\n  $('#submit').on('click', function() {\n    login();\n  });\n  $('#username').focus();\n  $('#closeDialog').on('click', function() {\n    $errorDialog.hide();\n    $errorMsg.text();\n    $('.login-dialog').removeClass('in');\n  });\n\n  function login() {\n    var json = verify();\n    if (!json) {\n      return;\n    }\n    $.ajax({\n      url: '/ehuodiBedrockApi/baseconfigcs/login',\n      type: 'post',\n      data: {\n        username: json.username,\n        password: json.password,\n        identifycode: json.captcha,\n      },\n      success: function(data) {\n        if (data) {\n          if (data.result === 'success') {\n            $.cookie('session_key', data.data.session_key, {\n              path: '/',\n              // domain: window.location.hostname !== 'location' ? window.location.host : ''\n            });\n            $.cookie('jobcard', data.data.jobcard, {\n              path: '/',\n              // domain: window.location.hostname !== 'location' ? window.location.host : ''\n            });\n            $.cookie('username', data.data.username, {\n              path: '/',\n              // domain: window.location.hostname !== 'location' ? window.location.host : ''\n            });\n            $('.form-logo').addClass('logo-show');\n            $('.login-mascot').removeClass('login-mascot-bounce');\n            setTimeout(function() {\n              $('.login-mascot').addClass('login-mascot-fly');\n            });\n            setTimeout(function() {\n              // TODO: 判断开发环境\n              if (process.env.NODE_ENV === 'development') {\n                window.location.href = '/';\n              } else {\n                window.location.href = '/scms/';\n              }\n            }, 700);\n          } else {\n            if (data.code === 'TF001020433205') {\n              $errorDialog.show();\n              $errorMsg.text(\n                '风豹系统为易货嘀运营管理后台，非货嘀公司人员不能登录。如有需要，请联系管理员（17776@etransfar.com）核实开通。'\n              );\n              $('.login-dialog').addClass('in');\n            } else {\n              $text.text(data.msg);\n            }\n          }\n        } else {\n          $text.text('登录失败');\n        }\n      },\n      error: function() {\n        $text.text('登录失败');\n      },\n    });\n  }\n});\n\nfunction verify(num) {\n  var $text = $('.login-error-msg');\n  var username = $('#username').val(),\n    password = $('#password').val(),\n    captcha = $('#captcha').val();\n  if (!username) {\n    $text.text('请输入您的登录名(如工号)');\n    return;\n  }\n  if (!password) {\n    $text.text('请输入您的密码');\n    return;\n  }\n  if (!captcha && !num) {\n    $text.text('请输入验证码');\n    return;\n  }\n  $text.text('');\n  return {\n    username: username,\n    password: password,\n    captcha: captcha,\n  };\n}\n"],"sourceRoot":""}