(window.scms=window.scms||[]).push([[4],{Ik1R:function(module,exports,__webpack_require__){},TGJ9:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.createDevTool=void 0,__webpack_require__("Ik1R");var _DevTool2=_interopRequireDefault(__webpack_require__("ebGU")),_DevMapStore2=_interopRequireDefault(__webpack_require__("yXoN"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}exports.createDevTool=function(defaultModuleMap){var store=new _DevMapStore2.default;return new _DevTool2.default(store,defaultModuleMap)}},ebGU:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}();var DevTool=function(){function DevTool(store,defaultModuleMap){var _this=this;!function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,DevTool),this.store=store,this.defaultModuleMap=defaultModuleMap,this.root=document.createElement("div"),this.root.classList.add("devTool"),this.store.read().then(function(devMap){_this.setup(devMap)}),this.state={active:!1}}return _createClass(DevTool,[{key:"setup",value:function(devMap){var _this2=this,editors=Object.keys(this.defaultModuleMap).map(function(key){var path=_this2.defaultModuleMap[key],checked=!1;return devMap[key]&&(path=devMap[key],checked=!0),'<div class="editor-row">\n          <div class="editor-row-check">\n            <label>\n              <input type="checkbox" '+(checked?"checked":"")+' />\n              <s></s>\n            </label>\n          </div>\n          <div class="editor-row-key">'+key+'</div>\n          <div class="editor-row-path">\n            <input name="'+key+'" type="text" value="'+path+'" '+(checked?"":"disabled")+" />\n          </div>\n        </div>"});this.root.innerHTML='\n      <button class="devTool__Toggle"></button>\n      <div class="devTool__EditorWrap">\n        <div id="J_DevTool_editor" class="devTool__Editor">'+editors.join("")+'</div>\n        <div class="devTool__actions">\n          <button type="button" class="devTool__ActionButton devTool__ActionButton--confirm">确定</button>\n          <button type="button" class="devTool__ActionButton devTool__ActionButton--reset">重置</button>\n          <button type="button" class="devTool__ActionButton devTool__ActionButton--exit">退出</button>\n        </div>\n      </div>\n    ',this.attachToDom(),this.initEvent(),this.editor=this.root.querySelector(".devTool__Editor")}},{key:"_updateState",value:function(){this.state.active?this.root.classList.add("devTool--active"):this.root.classList.remove("devTool--active")}},{key:"initEvent",value:function(){var _this3=this;this.root.querySelector(".devTool__Toggle").addEventListener("click",function(){_this3.state.active=!_this3.state.active,_this3._updateState()},!1),this.root.querySelector(".devTool__ActionButton--confirm").addEventListener("click",function(){_this3.submitDevMap()},!1),this.root.querySelector(".devTool__ActionButton--reset").addEventListener("click",function(){_this3.resetDevMap()},!1),this.root.querySelector(".devTool__ActionButton--exit").addEventListener("click",function(){_this3.exitDevMode()},!1),document.querySelector("#J_DevTool_editor").addEventListener("click",function(e){var target=e.target;if("input"===target.tagName.toLowerCase()&&"checkbox"===target.type){var row=target.parentElement.parentElement.parentElement,checked=target.checked;row.querySelector('input[type="text"]').disabled=checked?"":"disabled"}},!1)}},{key:"attachToDom",value:function(){document.body.appendChild(this.root)}},{key:"submitDevMap",value:function(){var fields=this.root.querySelectorAll('input[type="text"]'),map={};[].forEach.call(fields,function(field){field.disabled||Object.assign(map,function(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}({},field.name,field.value))}),this.saveMapToDB(map)}},{key:"resetDevMap",value:function(){this.saveMapToDB({})}},{key:"saveMapToDB",value:function(map){this.store.write(map).then(function(){history.replaceState(null,null,"?debug=true"+location.hash),window.location.reload()}).catch(function(err){console.warn("[DevTool Error]: Save Map failed!",err),console.warn("[Error Context]:",map)})}},{key:"exitDevMode",value:function(){history.pushState(null,null,"?"+location.hash),window.location.reload()}}]),DevTool}();exports.default=DevTool},yXoN:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_localforage2=_interopRequireDefault(__webpack_require__("q5lb"));_interopRequireDefault(__webpack_require__("7ffQ"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}_localforage2.default.config({name:"SCMS_DEV_TOOL"});var DevMapStore=function(){function DevMapStore(){!function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,DevMapStore)}return _createClass(DevMapStore,[{key:"read",value:function(){var _ref=function(fn){return function(){var gen=fn.apply(this,arguments);return new Promise(function(resolve,reject){return function step(key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}if(!info.done)return Promise.resolve(value).then(function(value){step("next",value)},function(err){step("throw",err)});resolve(value)}("next")})}}(regeneratorRuntime.mark(function _callee(){var map;return regeneratorRuntime.wrap(function(_context){for(;;)switch(_context.prev=_context.next){case 0:return map=void 0,_context.prev=1,_context.next=4,_localforage2.default.getItem("GLOBAL_DEV_MAP_STORE");case 4:map=_context.sent,_context.next=10;break;case 7:_context.prev=7,_context.t0=_context.catch(1),console.warn("[DevTool Error]: read store failed!",_context.t0);case 10:return _context.abrupt("return",map||{});case 11:case"end":return _context.stop()}},_callee,this,[[1,7]])}));return function(){return _ref.apply(this,arguments)}}()},{key:"write",value:function(content){return _localforage2.default.setItem("GLOBAL_DEV_MAP_STORE",content)}}]),DevMapStore}();exports.default=DevMapStore}}]);
//# sourceMappingURL=4.239a75dd.js.map